# BRN-004: 当前讨论总结（简要 <=20行）
1) 通信协议：全链路改为 GraphQL，SDL 存于 `libs/schema/schema.graphql`，禁止 ad-hoc JSON/proto；前后端/回归共享同一 Schema。
2) Ping-pong：GraphQL `ping` 通过 `regression:ping`，并且 `regression:infra-flow`、`regression:web-e2e` 在启动 Podman machine 后均已通过。
3) Protobuf 处理：删除所有 `.proto`、生成物、descriptor，移除 proto 代码路径/命令，CORS/代理等均指向 `/graphql`。
4) 后端：Flask + Ariadne，GraphQL resolvers 覆盖 `ping/pegStocks/singleStock`；tests 改为 GraphQL；Dockerfile 与 Nx targets 不再依赖 proto 生成。
5) 前端：React Native/Vite 改用 GraphQL fetch，移除 protobuf 解码；回归脚本与 nginx 代理改指 `/graphql`。
6) 容器/依赖：回归用容器启动 Neo4j；需要 Docker/Podman daemon。Python 依赖通过 `apps/backend/requirements.txt` + venv，JS 依赖统一根 package.json。
7) 系统前置：宿主需 Node/npm、Python 3.9+、Docker/Podman（运行中），Neo4j 由容器提供；如需全容器化可追加 compose。
8) 依赖边界：JS/TS 通过 Nx tags/dep-graph 限制跨层引用；Python 默认共用 backend venv，如有冲突再独立。
9) 文档更新：AGENTS/arch/TRD-002/phase README 等已指向 GraphQL；deploy 文档使用 GraphQL curl；新 BRN-002/003 移至 origin，BRN-002 总结为 GraphQL 协议。
10) 运行验证：`nx run backend:test`，`regression:ping`，`regression:infra-flow`，`regression:web-e2e` 在 Podman machine 启动后均通过。

# ä¸ºä»€ä¹ˆä¿ç•™investpyï¼Ÿ

**æ—¥æœŸ**: 2025-11-15  
**å†³ç­–**: ä¿ç•™investpy + é›†æˆfinnhub

---

## ğŸ’¡ ä¿ç•™investpyçš„ç†ç”±

### 1. æ•°æ®æºå¤šæ ·æ€§ â­

è™½ç„¶investpyæœ‰é™é€Ÿå’Œåçˆ¬è™«é—®é¢˜ï¼Œä½†å®ƒæä¾›**ç‹¬ç‰¹ä»·å€¼**ï¼š

```
yfinance   â†’ Yahoo Financeï¼ˆç¾å›½è§†è§’ï¼‰
finnhub    â†’ å®˜æ–¹é‡‘èæ•°æ®APIï¼ˆå…¨çƒï¼‰
investpy   â†’ investing.comï¼ˆæ¬§æ´²è§†è§’ï¼‰
```

**ä»·å€¼**: ä¸‰ä¸ªä¸åŒåœ°åŒº/è§†è§’çš„æ•°æ®æºï¼Œå¯ä»¥å‘ç°æ•°æ®ä¸ä¸€è‡´æ€§

### 2. æ¸¯è‚¡æ•°æ®ä¼˜åŠ¿ ğŸ‡­ğŸ‡°

**æ¸¯è‚¡æ”¯æŒå¯¹æ¯”**:
- yfinance: âš ï¸ éƒ¨åˆ†æ¸¯è‚¡æ•°æ®ä¸å…¨ï¼ˆæˆ‘ä»¬é‡åˆ°äº†00700å¤±è´¥ï¼‰
- finnhub: âš ï¸ æ¸¯è‚¡è¦†ç›–æœ‰é™
- **investpy: âœ… investing.comå¯¹æ¸¯è‚¡è¦†ç›–å¾ˆå¥½**

**å®é™…ä»·å€¼**: 
```python
# è…¾è®¯00700.HK
yfinance:  âŒ ç»å¸¸å¤±è´¥
finnhub:   âš ï¸ å¯èƒ½æ²¡æœ‰
investpy:  âœ… æ•°æ®å®Œæ•´
```

### 3. ä½œä¸ºå¤‡ç”¨éªŒè¯æº ğŸ”„

**ç­–ç•¥**: 
- ä¸»åŠ›: yfinance + finnhubï¼ˆå¿«é€Ÿã€ç¨³å®šï¼‰
- å¤‡ç”¨: investpyï¼ˆä»…å½“å‰ä¸¤ä¸ªä¸ä¸€è‡´æˆ–å¤±è´¥æ—¶ï¼‰

**å®æ–½**:
```python
# æ™ºèƒ½é™çº§ç­–ç•¥
if yfinance_data and finnhub_data:
    if data_consistent(yfinance_data, finnhub_data):
        # æ•°æ®ä¸€è‡´ï¼Œä¸éœ€è¦investpy
        return aggregated_data
    else:
        # æ•°æ®ä¸ä¸€è‡´ï¼Œä½¿ç”¨investpyä½œä¸ºç¬¬ä¸‰æ–¹éªŒè¯
        investpy_data = fetch_investpy(ticker)
        return vote_best_data([yf, fh, inv])
else:
    # ä¸»åŠ›æºå¤±è´¥ï¼Œå°è¯•investpy
    return fetch_investpy(ticker)
```

### 4. é•¿æœŸä»·å€¼ ğŸ“ˆ

**ç°çŠ¶**: investpyå› åçˆ¬è™«é—®é¢˜ä¸ç¨³å®š

**ä½†**:
- investing.comæ˜¯å…¨çƒçŸ¥åé‡‘èç½‘ç«™
- investpyç¤¾åŒºå¯èƒ½ä¼šæ”¹è¿›åçˆ¬è™«æªæ–½
- ä¿ç•™ä»£ç ï¼Œæœªæ¥å¯èƒ½å˜å¾—å¯ç”¨

**æˆæœ¬**: 
- ä»£ç å·²å®ç°
- åªéœ€ä¿ç•™ï¼Œä¸å¼ºåˆ¶ä½¿ç”¨
- å¦‚æœå¤±è´¥ï¼Œä¼˜é›…é™çº§

---

## ğŸ¯ æ–°æ–¹æ¡ˆï¼šä¸‰æºéªŒè¯

### æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æ•°æ®é‡‡é›†å±‚                   â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚yfinanceâ”‚  â”‚finnhub â”‚  â”‚investpyâ”‚â”‚
â”‚  â”‚ (ä¸»åŠ›) â”‚  â”‚ (ä¸»åŠ›) â”‚  â”‚ (å¤‡ç”¨) â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚      â–¼            â–¼          â–¼     â”‚
â””â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”˜
       â”‚            â”‚          â”‚
       â–¼            â–¼          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         éªŒè¯å±‚                       â”‚
â”‚                                     â”‚
â”‚  å¦‚æœ yf && fh ä¸€è‡´                  â”‚
â”‚    â†’ ç›´æ¥è¿”å›ï¼ˆä¸ç”¨investpyï¼‰        â”‚
â”‚  å¦‚æœ yf && fh ä¸ä¸€è‡´                â”‚
â”‚    â†’ ä½¿ç”¨investpyä½œä¸ºä»²è£            â”‚
â”‚  å¦‚æœ yf || fh å¤±è´¥                  â”‚
â”‚    â†’ ä½¿ç”¨investpyä½œä¸ºå¤‡ä»½            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     aggregatedæ•°æ®                   â”‚
â”‚   ï¼ˆç»è¿‡ä¸‰æºéªŒè¯æˆ–åŒæºéªŒè¯ï¼‰          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¼˜åŠ¿

1. **é€Ÿåº¦**: ä¼˜å…ˆä½¿ç”¨å¿«é€Ÿæºï¼ˆyfinance + finnhubï¼‰
2. **å¯é æ€§**: finnhubæ˜¯å®˜æ–¹APIï¼Œç¨³å®šæ€§é«˜
3. **è¦†ç›–**: investpyä½œä¸ºå¤‡ç”¨ï¼Œè¦†ç›–æ¸¯è‚¡ç­‰ç‰¹æ®Šæƒ…å†µ
4. **çµæ´»æ€§**: æ™ºèƒ½é™çº§ï¼Œä¸å¼ºä¾èµ–investpy

---

## ğŸ”§ Finnhubé›†æˆ

### Finnhubä¼˜åŠ¿

| ç»´åº¦ | Finnhub | yfinance | investpy |
|------|---------|----------|----------|
| **ç±»å‹** | å®˜æ–¹API | çˆ¬è™« | çˆ¬è™« |
| **ç¨³å®šæ€§** | â­â­â­â­â­ | â­â­â­â­ | â­â­ |
| **é™é€Ÿ** | 60/minï¼ˆå…è´¹ï¼‰ | æ— æ˜ç¡® | ä¸¥æ ¼ |
| **æ•°æ®** | PE, è´¢åŠ¡æ•°æ® | å®Œæ•´ | æœ‰é™ |
| **æ¸¯è‚¡** | æœ‰é™ | è¾ƒå¥½ | å¾ˆå¥½ |

### Finnhub APIè§„æ ¼

**å…è´¹tier**:
- 60 calls/minute
- 30 API calls/second
- æ”¯æŒè‚¡ç¥¨ä»·æ ¼ã€åŸºæœ¬é¢æ•°æ®

**æˆ‘ä»¬çš„ä½¿ç”¨**:
- 14åªè‚¡ç¥¨
- æ¯åªéœ€è¦2-3ä¸ªAPIè°ƒç”¨
- æ€»å…± ~40æ¬¡è°ƒç”¨
- âœ… å®Œå…¨åœ¨é™é¢å†…

**é™é€Ÿç­–ç•¥**:
```python
# finnhub: 60/min = 1ç§’/æ¬¡
finnhub_limiter = RateLimiter(min_interval=1.0)

# yfinance: æ— é™åˆ¶ï¼Œä½†å»ºè®®0.5ç§’/æ¬¡
yfinance_limiter = RateLimiter(min_interval=0.5)

# investpy: ä»…å¤‡ç”¨ï¼Œ3ç§’/æ¬¡
investpy_limiter = RateLimiter(min_interval=3.0)
```

---

## ğŸ“Š é¢„æœŸç»“æœ

### æ•°æ®æ–‡ä»¶
```
x-data/stock_fundamental/
â”œâ”€â”€ stock_fundamental-mag7-yfinance-20251115.csv      (11-13æ¡)
â”œâ”€â”€ stock_fundamental-mag7-finnhub-20251115.csv       (é¢„è®¡10-12æ¡) â­
â”œâ”€â”€ stock_fundamental-mag7-investpy-20251115.csv      (0-8æ¡ï¼Œå¤‡ç”¨)
â””â”€â”€ stock_fundamental-mag7-aggregated-20251115.csv    (10-12æ¡) â­â­â­
```

### æ€§èƒ½
- **ä¸»åŠ›é‡‡é›†**: yfinance(7ç§’) + finnhub(14ç§’) = **21ç§’**
- **å¤‡ç”¨é‡‡é›†**: investpyä»…åœ¨éœ€è¦æ—¶è°ƒç”¨
- **æ€»è€—æ—¶**: é¢„è®¡20-30ç§’ï¼ˆvs å½“å‰çš„7ç§’ï¼Œä½†æ•°æ®è´¨é‡æ›´é«˜ï¼‰

### è´¨é‡æå‡
- agent.md (28)ç¬¦åˆåº¦: 70% â†’ **100%** âœ…
- aggregatedæ•°æ®: 6æ¡ â†’ 10-12æ¡ (+67-100%)
- æ•°æ®ç½®ä¿¡åº¦: åŒæºéªŒè¯ â†’ ä¸‰æºéªŒè¯ï¼ˆæ›´å¯é ï¼‰

---

## âœ… å®æ–½è®¡åˆ’

1. **å®ç°finnhubæ¨¡å—** (10åˆ†é’Ÿ)
   - fetch_finnhub.py
   - ä½¿ç”¨ç¯å¢ƒå˜é‡FINNHUB_TOKEN
   - å®ç°PEã€PEGã€è´¢åŠ¡æ•°æ®è·å–

2. **ä¼˜åŒ–investpyæ¨¡å—** (10åˆ†é’Ÿ)
   - æ·»åŠ é™é€Ÿå’Œé‡è¯•
   - è®¾ç½®ä¸ºå¤‡ç”¨æ¨¡å¼

3. **å®ç°æ™ºèƒ½ä¸‰æºéªŒè¯** (15åˆ†é’Ÿ)
   - ä¸»åŠ›ï¼šyfinance + finnhub
   - å¤‡ç”¨ï¼šinvestpyï¼ˆä»…åœ¨éœ€è¦æ—¶ï¼‰
   - æ™ºèƒ½é™çº§ç­–ç•¥

4. **è¿è¡Œå®Œæ•´é‡‡é›†** (5åˆ†é’Ÿ)
   - ç”Ÿæˆ4ä¸ªCSVæ–‡ä»¶
   - éªŒè¯æ•°æ®è´¨é‡

**æ€»è€—æ—¶**: 40åˆ†é’Ÿ
**æ”¶ç›Š**: agent.md (28)ä»70%æå‡åˆ°100% â­


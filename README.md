# PEG Scanner

This project is a stock analysis tool for quantitative stock selection, focusing on US stocks. It is being developed using an "AI-native" approach, where an AI agent (like me) actively participates in the development process.

The core requirements and instructions for the agent are defined in [AGENTS.md](./AGENTS.md).

## Installation

To set up the Nx monorepo workspace, navigate to the project's root directory and run the following command:

```bash
npx nx init peg-scanner --prefer-free-syntax
```

This command will initialize the Nx workspace directly within the current directory, naming it `peg-scanner`. Follow any prompts to configure the workspace. It's recommended to choose an "integrated" monorepo style for mixed technologies (React Native and Python).

## Development Workflow

1. Run `npm run lint:structure` to ensure the workspace layout remains compliant.
2. (Optional) Export `ENV=/path/to/.env` so `tools/dev.sh` can load custom variables (ports, API keys, etc.).
3. Start services with `./tools/dev.sh start` (defaults to `backend` + `mobile`, or pass specific services e.g., `./tools/dev.sh start backend`). Commands run under `nohup` with logs/PIDs in `x-log/`.
4. Run automated checks:
   - Backend proto tests: `npx nx run backend:test`
   - Regression ping: `npx nx run regression:ping` (backend server must be running)
   - Mobile typecheck: `npx nx run mobile:typecheck`
5. Stop services with `./tools/dev.sh stop` (or `./tools/dev.sh stop backend`).

## Directory Index

*   [`/docs/`](./docs/README.md): High-level documentation, including [`AI_EVALUATION.md`](./docs/AI_EVALUATION.md), phase folders (`./docs/project/`), and the stage tracker [`docs/TODOWRITE.md`](./docs/TODOWRITE.md).
*   [`/apps/`](./apps/README.md): Runtime applications (backend API, mobile client, regression utilities) managed by Nx.
*   [`/libs/schema/`](./libs/schema/README.md): The Single Source of Truth (SSOT) for data structures, defined using Protobuf.
*   [`/tools/`](./tools/README.md): Automation helpers such as [`tools/dev.sh`](./tools/dev.sh) for starting/stopping services with env injection.
*   [`/x-data/`](./x-data/README.md): Stores all data automatically generated by the application (e.g., stock data, calculated factors).
*   [`/x-log/`](./x-log/README.md): Contains logs from the application's various components.
*   [`docs/PRD.md`](./docs/PRD.md): Product requirements + functional backlog.
*   [`AGENTS.md`](./AGENTS.md): SOP/checklists and workflow guardrails for every agent (read before making any change).

## Root Files

- `package.json` / `package-lock.json`: Node + Nx dependencies and scripts (e.g., `npm run lint:structure`).
- `nx.json` / `tsconfig.base.json`: Nx workspace + shared TypeScript compiler configuration.
- `.gitignore`, `.prettierrc`, `.prettierignore`: SCM and formatting policies.
- `nx` / `nx.bat`: Nx CLI entry points.

# Data 目录重新设计

## 新要求 (agent.md 30-31)

### Line 30
"本质相同但是不同来源的数据(你加工之后的置信数据也可以认为是一个source)
 应当遵循 schema 且请放到一个文件夹"

### Line 31  
"命名规则为 schema-name-source-date.csv"
示例: etf_portfolio-vgt-yfinance-20240101_20251114.csv

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 新的数据组织原则

### 1. 按 Schema 分类（不是按处理阶段）

旧方式 (❌):
- raw/
- processed/
- cache/
- results/

新方式 (✅):
- stock_daily/          # schema: 日度数据
- stock_fundamental/    # schema: 基本面数据
- etf_portfolio/        # schema: ETF持仓
- backtest_result/      # schema: 回测结果
- analysis_result/      # schema: 分析结果

### 2. 文件命名规范

格式: `{schema}-{name}-{source}-{date}.csv`

组成部分:
- schema: stock_daily, stock_fundamental, etf_portfolio 等
- name: 数据集名称 (mag7, sp500, vgt, tsla 等)
- source: 数据来源 (yfinance, alphavantage, aggregated, backtest 等)
- date: 日期范围 (YYYYMMDD 或 YYYYMMDD_YYYYMMDD)

示例:
- stock_daily-mag7-yfinance-20251115.csv
- stock_fundamental-mag7-aggregated-20251115.csv
- etf_portfolio-vgt-yfinance-20240101_20251114.csv
- backtest_result-tsla-strategy1-20000101_20251115.csv

### 3. 多数据源处理

同一数据的不同来源都放在同一schema文件夹:
```
stock_fundamental/
├── stock_fundamental-mag7-yfinance-20251115.csv
├── stock_fundamental-mag7-alphavantage-20251115.csv
├── stock_fundamental-mag7-aggregated-20251115.csv  # 加工后的置信数据
└── README.md
```

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## Schema 定义

### 1. stock_daily (日度行情)
字段: date, ticker, open, high, low, close, volume
用途: 历史价格数据

### 2. stock_fundamental (基本面)
字段: ticker, date, price, pe, peg, net_income, growth_rate, market_cap
用途: PEG分析、估值

### 3. etf_portfolio (ETF持仓)
字段: etf_ticker, date, holding_ticker, weight, shares, market_value
用途: ETF成分股分析

### 4. backtest_result (回测结果)
字段: ticker, date, strategy, position, pnl, cumulative_return
用途: 策略回测

### 5. analysis_result (分析结果)
字段: depends on analysis type
用途: 各种分析输出

